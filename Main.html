<!DOCTYPE HTML>

<html>
    <head>
        <meta charset="UTF-8">
        <title>
            Main
        </title>
        <script type="text/javascript" src="elm-runtime.js">
            
        </script>
        <script type="text/javascript">
            
Elm.Main = function(elm){
  var N = Elm.Native, _N = N.Utils(elm), _L = N.List(elm), _E = N.Error(elm), _J = N.JavaScript(elm), _str = _J.toString, $moduleName = 'Main';
  var Text = Elm.Text(elm);
  var Text = Elm.Text(elm);
  var Basics = Elm.Basics(elm);
  var Signal = Elm.Signal(elm);
  var List = Elm.List(elm);
  var Maybe = Elm.Maybe(elm);
  var Time = Elm.Time(elm);
  var Prelude = Elm.Prelude(elm);
  var Graphics = Graphics || {};
  Graphics.Element = Elm.Graphics.Element(elm);
  var Color = Elm.Color(elm);
  var Graphics = Graphics || {};
  Graphics.Collage = Elm.Graphics.Collage(elm);
  var List = Elm.List(elm);
  var Dict = Elm.Dict(elm);
  var Dict = Elm.Dict(elm);
  var Set = Elm.Set(elm);
  var Set = Elm.Set(elm);
  var Maybe = Elm.Maybe(elm);
  var Color = Elm.Color(elm);
  var Automaton = Elm.Automaton(elm);
  var Point2D = Elm.Point2D(elm);
  var Point2D = Elm.Point2D(elm);
  var Graph = Elm.Graph(elm);
  var Graph = Elm.Graph(elm);
  var Physics = Elm.Physics(elm);
  var TGF = Elm.TGF(elm);
  var TGF = Elm.TGF(elm);
  var GUI = Elm.GUI(elm);
  var GUI = Elm.GUI(elm);
  var Window = Elm.Window(elm);
  var Keyboard = Elm.Keyboard(elm);
  var Mouse = Elm.Mouse(elm);
  var _op = {};
  var toggle = F2(function(start, input){
    return function(){
      var toggleFun = F2(function(inputIsTrue, arg1){
        return function(){
          switch (arg1.ctor) {
            case '_Tuple2':
              return {ctor:"_Tuple2", _0:((Basics.not(arg1._1)&&inputIsTrue) ? Basics.not(arg1._0) : (Basics.otherwise ? arg1._0 : _E.If($moduleName,'between lines 62 and 64'))), _1:inputIsTrue};
          }_E.Case($moduleName,'between lines 62 and 65')}();});
      return A2(Signal._op['<~'], Basics.fst, A3(Signal.foldp, toggleFun, {ctor:"_Tuple2", _0:start, _1:false}, input));}();});
  var test1 = {
    _:{
    },
    edges:Dict.fromList(_J.toList([{ctor:"_Tuple2", _0:1, _1:{
    _:{
    },
    eid:1,
    idFrom:1,
    idTo:2,
    label:_str('1')}},{ctor:"_Tuple2", _0:2, _1:{
    _:{
    },
    eid:2,
    idFrom:3,
    idTo:1,
    label:_str('2')}},{ctor:"_Tuple2", _0:3, _1:{
    _:{
    },
    eid:3,
    idFrom:2,
    idTo:3,
    label:_str('3')}}])),
    nodes:Dict.fromList(_J.toList([{ctor:"_Tuple2", _0:1, _1:{
    _:{
    },
    bEdges:Set.fromList(_J.toList([2])),
    edges:Set.fromList(_J.toList([1])),
    label:_str('1'),
    nid:1,
    pos:{
    _:{
    },
    x:15,
    y:15},
    vel:{
    _:{
    },
    x:0,
    y:0}}},{ctor:"_Tuple2", _0:2, _1:{
    _:{
    },
    bEdges:Set.fromList(_J.toList([1])),
    edges:Set.fromList(_J.toList([3])),
    label:_str('2'),
    nid:2,
    pos:{
    _:{
    },
    x:35,
    y:5},
    vel:{
    _:{
    },
    x:0,
    y:0}}},{ctor:"_Tuple2", _0:3, _1:{
    _:{
    },
    bEdges:Set.fromList(_J.toList([3])),
    edges:Set.fromList(_J.toList([2])),
    label:_str('3'),
    nid:3,
    pos:{
    _:{
    },
    x:15,
    y:15},
    vel:{
    _:{
    },
    x:0,
    y:0}}}]))};
  var nodesAt = Graph.nodesWithin(GUI.nodeRadius);
  var headToMaybeAndList = function(l){
    return function(){
      switch (l.ctor) {
        case '::':
          return {ctor:"_Tuple2", _0:Maybe.Just(l._0), _1:_J.toList([l._0])};
        case '[]':
          return {ctor:"_Tuple2", _0:Maybe.Nothing, _1:_J.toList([])};
      }_E.Case($moduleName,'between lines 69 and 71')}();};
  var frameRate = 30;
  var editGraph = F4(function(mouseDown, mouseRelPos, hoverNodes, programState){
    return function(){
      var noNodeDrag = function(){
        var _6 = headToMaybeAndList(hoverNodes);
        var lSelectedNode = function(){
          switch (_6.ctor) {
            case '_Tuple2':
              return _6._1;
          }_E.Case($moduleName,'on line 83, column 42 to 71')}();
        var mSelectedNode = function(){
          switch (_6.ctor) {
            case '_Tuple2':
              return _6._0;
          }_E.Case($moduleName,'on line 83, column 42 to 71')}();
        var newMode = (mouseDown ? A2(GUI.Edit, GUI.Drag(mSelectedNode), lSelectedNode) : (Basics.otherwise ? A2(GUI.Edit, GUI.Drag(Maybe.Nothing), _J.toList([])) : _E.If($moduleName,'on line 84, column 19 to 104')));
        var newState = _N.replace([['mode',newMode]], programState);
        return {ctor:"_Tuple2", _0:newState, _1:lSelectedNode};}();
      return function(){
        var case13 = programState.mode;
        switch (case13.ctor) {
          case 'Edit':
            switch (case13._0.ctor) {
              case 'Drag':
                switch (case13._0._0.ctor) {
                  case 'Just':
                    return function(){
                      var relMove = A2(Point2D.e_min, mouseRelPos, case13._0._0._0.pos);
                      var newSelection = A2(List.map, function(node){
                        return _N.replace([['pos',A2(Point2D.e_pls, node.pos, relMove)]], node);}, case13._1);
                      var newGraph = A3(List.foldl, F2(function(node, graph){
                        return _N.replace([['nodes',A3(Dict.insert, node.nid, node, graph.nodes)]], graph);}), programState.graph, newSelection);
                      var newDragNode = _N.replace([['pos',A2(Point2D.e_pls, case13._0._0._0.pos, relMove)]], case13._0._0._0);
                      var newMode = A2(GUI.Edit, GUI.Drag((mouseDown ? Maybe.Just(newDragNode) : (Basics.otherwise ? Maybe.Nothing : _E.If($moduleName,'on line 99, column 31 to 78')))), newSelection);
                      var newProgramState = {
                        _:{
                        },
                        graph:newGraph,
                        mode:newMode};
                      return {ctor:"_Tuple2", _0:newProgramState, _1:newSelection};}();
                  case 'Nothing':
                    return noNodeDrag;
                }break;
            }break;
          case 'Simulation':
            return noNodeDrag;
        }_E.Case($moduleName,'between lines 88 and 102')}();}();});
  var step = F5(function(render, timeDelta, mouseDown, relMousePos, programState){
    return function(){
      var hoverNodes = nodesAt(programState.graph)(relMousePos);
      return (render ? {ctor:"_Tuple2", _0:{
        _:{
        },
        graph:A2(Physics.physicsStep, timeDelta, programState.graph),
        mode:GUI.Simulation}, _1:hoverNodes} : (Basics.otherwise ? A4(editGraph, mouseDown, relMousePos, hoverNodes, programState) : _E.If($moduleName,'between lines 107 and 109')));}();});
  var dimensions = A2(Signal._op['<~'], GUI.dimensionsFromWindow, Window.dimensions);
  var createGraph = function(){
    var nc = Physics.nodeConstants;
    return Graph.createGraph((nc.radius*4));}();
  var test2 = createGraph({
    _:{
    },
    edges:_J.toList([{
    _:{
    },
    idFrom:1,
    idTo:2,
    label:_str('1')},{
    _:{
    },
    idFrom:3,
    idTo:1,
    label:_str('2')},{
    _:{
    },
    idFrom:2,
    idTo:3,
    label:_str('3')},{
    _:{
    },
    idFrom:1,
    idTo:4,
    label:_str('4')},{
    _:{
    },
    idFrom:2,
    idTo:4,
    label:_str('5')},{
    _:{
    },
    idFrom:4,
    idTo:3,
    label:_str('6')}]),
    nodes:_J.toList([{
    _:{
    },
    id:1,
    label:_str('1')},{
    _:{
    },
    id:2,
    label:_str('2')},{
    _:{
    },
    id:3,
    label:_str('3')},{
    _:{
    },
    id:4,
    label:_str('4')}])});
  var test3 = createGraph(TGF.fromString(_str('1 January\n2 March\n3 April\n4 May\n5 December\n6 June\n7 September\n#\n1 2\n3 2\n4 3\n5 1 Happy New Year!\n5 3 April Fools Day\n6 3\n6 1\n7 5\n7 6\n7 1')));
  var checkFrameRate = function(r){
    return (_N.cmp(r,(frameRate/2))<0);};
  var seconds = A2(Signal.keepIf, checkFrameRate, frameRate)(A2(Signal._op['<~'], Time.inSeconds, Time.fps(frameRate)));
  var transform = A2(Signal._op['~'], A2(Signal._op['~'], A2(Signal._op['~'], A2(Signal._op['<~'], step, GUI.simulate), seconds), Mouse.isDown), A2(Signal._op['~'], A2(Signal._op['<~'], GUI.relativeMousePosition, dimensions), A2(Signal._op['<~'], function($){
    return Point2D.cartesian(function(arg1){
      return function(){
        switch (arg1.ctor) {
          case '_Tuple2':
            return {ctor:"_Tuple2", _0:Basics.toFloat(arg1._0), _1:Basics.toFloat(arg1._1)};
        }_E.Case($moduleName,'on line 112, column 131 to 151')}();}($));}, Mouse.position)));
  var programState$ = A3(Signal.foldp, F2(function(transformFun, arg1){
    return function(){
      switch (arg1.ctor) {
        case '_Tuple2':
          return transformFun(arg1._0);
      }_E.Case($moduleName,'on line 149, column 51 to 69')}();}), {ctor:"_Tuple2", _0:{
    _:{
    },
    graph:test3,
    mode:GUI.Simulation}, _1:_J.toList([])}, transform);
  var main = A2(Signal._op['~'], A2(Signal._op['<~'], GUI.scene, dimensions), programState$);
  return elm.Main = {
    _op : _op, 
    frameRate : frameRate, 
    checkFrameRate : checkFrameRate, 
    nodesAt : nodesAt, 
    toggle : toggle, 
    headToMaybeAndList : headToMaybeAndList, 
    createGraph : createGraph, 
    seconds : seconds, 
    editGraph : editGraph, 
    step : step, 
    transform : transform, 
    test1 : test1, 
    test2 : test2, 
    test3 : test3, 
    programState$ : programState$, 
    dimensions : dimensions, 
    main : main};};
Elm.GUI = function(elm){
  var N = Elm.Native, _N = N.Utils(elm), _L = N.List(elm), _E = N.Error(elm), _J = N.JavaScript(elm), _str = _J.toString, $moduleName = 'GUI';
  var Text = Elm.Text(elm);
  var Text = Elm.Text(elm);
  var Basics = Elm.Basics(elm);
  var Signal = Elm.Signal(elm);
  var List = Elm.List(elm);
  var Maybe = Elm.Maybe(elm);
  var Time = Elm.Time(elm);
  var Prelude = Elm.Prelude(elm);
  var Graphics = Graphics || {};
  Graphics.Element = Elm.Graphics.Element(elm);
  var Color = Elm.Color(elm);
  var Graphics = Graphics || {};
  Graphics.Collage = Elm.Graphics.Collage(elm);
  var Graphics = Graphics || {};
  Graphics.Input = Elm.Graphics.Input(elm);
  var Point2D = Elm.Point2D(elm);
  var Point2D = Elm.Point2D(elm);
  var Graph = Elm.Graph(elm);
  var Graph = Elm.Graph(elm);
  var List = Elm.List(elm);
  var Dict = Elm.Dict(elm);
  var Dict = Elm.Dict(elm);
  var Set = Elm.Set(elm);
  var Set = Elm.Set(elm);
  var Color = Elm.Color(elm);
  var _op = {};
  var nodeRadius = 3;
  var drawNode = F2(function(c, p){
    return Graphics.Collage.move({ctor:"_Tuple2", _0:p.x, _1:p.y})(Graphics.Collage.filled(c)(Graphics.Collage.circle(nodeRadius)));});
  var drawNodes = F2(function(g, ncolor){
    return function(){
      var node2form = function(n){
        return A2(drawNode, ncolor(n.nid), n.pos);};
      return List.map(node2form)(Dict.values(g.nodes));}();});
  var drawEdge = F3(function(c, p1, p2){
    return Graphics.Collage.traced(Graphics.Collage.solid(c))(A2(Graphics.Collage.segment, {ctor:"_Tuple2", _0:p1.x, _1:p1.y}, {ctor:"_Tuple2", _0:p2.x, _1:p2.y}));});
  var drawEdges = F2(function(g, ecolor){
    return function(){
      var edge2form = F3(function(arg3, e, acc){
        return function(){
          return function(){
            var case1 = {ctor:"_Tuple2", _0:A2(Dict.lookup, e.idFrom, g.nodes), _1:A2(Dict.lookup, e.idTo, g.nodes)};
            switch (case1.ctor) {
              case '_Tuple2':
                switch (case1._0.ctor) {
                  case 'Just':
                    switch (case1._1.ctor) {
                      case 'Just':
                        return _L.Cons(A3(drawEdge, ecolor(e.eid), case1._0._0.pos, case1._1._0.pos),acc);
                    }break;
                }break;
            }
            return acc;}();}();});
      return A3(Dict.foldl, edge2form, _J.toList([]), g.edges);}();});
  var drawGraph = F3(function(g, ncolor, ecolor){
    return _L.append(A2(drawEdges, g, ecolor),A2(drawNodes, g, ncolor));});
  var dimensionsFromHeight = function(height){
    return function(){
      var renderAreaSize = (height-20);
      var panelWidth = Basics.floor(F2(function(x, y){
        return (x*y);})(0.25)(Basics.toFloat(renderAreaSize)));
      return {ctor:"_Tuple3", _0:height, _1:panelWidth, _2:renderAreaSize};}();};
  var colors = {
    _:{
    },
    collage:A3(Color.rgb, 245, 245, 245),
    edge:{
    _:{
    },
    hover:Color.lightRed,
    normal:Color.red},
    node:{
    _:{
    },
    hover:Color.lightBlue,
    normal:Color.blue}};
  var collageCenter = function(dimensions){
    return function(){
      var y = (Basics.toFloat(dimensions.buttonBar.height)+(Basics.toFloat(dimensions.renderArea.size)/2));
      var x = (Basics.toFloat((dimensions.window.width-dimensions.panel.width))/2);
      return Point2D.cartesian({ctor:"_Tuple2", _0:x, _1:y});}();};
  var relativeMousePosition = F2(function(dimensions, posV){
    return function(){
      var negateY = Point2D.e_mul(Point2D.cartesian({ctor:"_Tuple2", _0:1, _1:(0-1)}));
      var fromCenter = function(p){
        return Point2D.e_min(p)(collageCenter(dimensions));};
      return negateY(fromCenter(posV));}();});
  var buttonSize = 40;
  var dimensionsFromWidth = function(width){
    return function(){
      var panelWidth = Basics.floor(F2(function(x, y){
        return (x*y);})(0.2)(Basics.toFloat(width)));
      var renderAreaSize = (width-panelWidth);
      var height = (renderAreaSize+buttonSize);
      return {ctor:"_Tuple3", _0:height, _1:panelWidth, _2:renderAreaSize};}();};
  var border = F2(function(lineStyle, element){
    return function(){
      var width = Graphics.Element.widthOf(element);
      var height = Graphics.Element.heightOf(element);
      return A2(Graphics.Collage.collage, width, height)(_J.toList([Graphics.Collage.outlined(lineStyle)(A2(Graphics.Collage.rect, Basics.toFloat(width), Basics.toFloat(height))),Graphics.Collage.toForm(element)]));}();});
  var panel = F3(function(hoverNodes, width, height){
    return border(Graphics.Collage.defaultLine)(A3(Graphics.Element.container, width, height, Graphics.Element.topLeft)(Graphics.Element.flow(Graphics.Element.down)(A2(List.map, function($){
      return Text.plainText(function(_){
        return _.label;}($));}, hoverNodes))));});
  var renderAreaCollage = function(size){
    return function($){
      return border(Graphics.Collage.defaultLine)(A2(Graphics.Collage.collage, size, size)($));};};
  var Simulation = {ctor:"Simulation"};
  var Select = {ctor:"Select"};
  var ProgramState = F2(function(a, b){
    return {
      _:{
      },
      graph:a,
      mode:b};});
  var Edit = F2(function(a, b){
    return {ctor:"Edit", _0:a, _1:b};});
  var renderArea = F2(function(arg2, size){
    return function(){
      switch (arg2.ctor) {
        case '_Tuple2':
          return function(){
            var ncolor = function(nid){
              return (A2(List.any, function(hn){
                return _N.eq(nid,hn.nid);}, arg2._1) ? colors.node.hover : (Basics.otherwise ? colors.node.normal : _E.If($moduleName,'on line 134, column 20 to 107')));};
            var modeText = function(){
              var case9 = arg2._0.mode;
              switch (case9.ctor) {
                case 'Edit':
                  return _str('Edit');
                case 'Simulation':
                  return _str('Simulation');
              }_E.Case($moduleName,'between lines 139 and 142')}();
            var hoverNodeEdges = A3(List.foldl, F2(function(n, acc){
              return Set.union(n.edges)(A2(Set.union, n.bEdges, acc));}), Set.empty, arg2._1);
            var ecolor = function(eid){
              return (A2(Set.member, eid, hoverNodeEdges) ? colors.edge.hover : (Basics.otherwise ? colors.edge.normal : _E.If($moduleName,'on line 135, column 20 to 107')));};
            var drawnGraph = renderAreaCollage(size)(A3(drawGraph, arg2._0.graph, ncolor, ecolor));
            return Graphics.Element.layers(_J.toList([drawnGraph,Text.plainText(_L.append(_str('Mode: '),modeText))]));}();
      }_E.Case($moduleName,'between lines 132 and 142')}();});
  var Drag = function(a){
    return {ctor:"Drag", _0:a};};
  var Dimensions = F3(function(a, b, c){
    return {
      _:{
      },
      dimensions:c,
      height:b,
      width:a};});
  var dimensions2 = F2(function(width, height){
    return A3(Dimensions, width, height, {ctor:"_Tuple2", _0:width, _1:height});});
  var dimensions1 = function(size){
    return function(){
      var d = A2(dimensions2, size, size);
      return _N.insert('size', size, d);}();};
  var dimensionsFromWindow = function(arg1){
    return function(){
      switch (arg1.ctor) {
        case '_Tuple2':
          return function(){
            var _15 = function(){
              var fromWidth = dimensionsFromWidth(arg1._0);
              var _16 = fromWidth;
              var h = function(){
                switch (_16.ctor) {
                  case '_Tuple3':
                    return _16._0;
                }_E.Case($moduleName,'on line 52, column 21 to 30')}();
              return ((_N.cmp(h,arg1._1)<1) ? fromWidth : (Basics.otherwise ? dimensionsFromHeight(arg1._1) : _E.If($moduleName,'on line 53, column 10 to 78')));}();
            var height = function(){
              switch (_15.ctor) {
                case '_Tuple3':
                  return _15._0;
              }_E.Case($moduleName,'between lines 51 and 53')}();
            var panelWidth = function(){
              switch (_15.ctor) {
                case '_Tuple3':
                  return _15._1;
              }_E.Case($moduleName,'between lines 51 and 53')}();
            var renderAreaSize = function(){
              switch (_15.ctor) {
                case '_Tuple3':
                  return _15._2;
              }_E.Case($moduleName,'between lines 51 and 53')}();
            return {
              _:{
              },
              buttonBar:A2(dimensions2, renderAreaSize, buttonSize),
              panel:A2(dimensions2, panelWidth, height),
              renderArea:dimensions1(renderAreaSize),
              window:A2(dimensions2, arg1._0, arg1._1)};}();
      }_E.Case($moduleName,'between lines 50 and 58')}();};
  var ButtonSelect = {ctor:"ButtonSelect"};
  var ButtonRotate = {ctor:"ButtonRotate"};
  var ButtonMove = {ctor:"ButtonMove"};
  var _33 = function(){
    var source = Graphics.Input.buttons(false);
    var play = A2(source.button, true, _str('Play'));
    var pause = A2(source.button, false, _str('Pause'));
    return {ctor:"_Tuple3", _0:source.events, _1:play, _2:pause};}();
  var buttonPause = function(){
    switch (_33.ctor) {
      case '_Tuple3':
        return _33._2;
    }_E.Case($moduleName,'between lines 72 and 75')}();
  var buttonPlay = function(){
    switch (_33.ctor) {
      case '_Tuple3':
        return _33._1;
    }_E.Case($moduleName,'between lines 72 and 75')}();
  var simulate = function(){
    switch (_33.ctor) {
      case '_Tuple3':
        return _33._0;
    }_E.Case($moduleName,'between lines 72 and 75')}();
  var _46 = function(){
    var source = Graphics.Input.buttons(ButtonSelect);
    return {ctor:"_Tuple2", _0:source.events, _1:List.map(Basics.uncurry(source.button))(A2(List.map, function(b){
      return {ctor:"_Tuple2", _0:b, _1:List.drop(6)(Prelude.show(b))};}, _J.toList([ButtonSelect,ButtonMove,ButtonRotate])))};}();
  var buttonList = function(){
    switch (_46.ctor) {
      case '_Tuple2':
        return _46._1;
    }_E.Case($moduleName,'between lines 80 and 81')}();
  var buttonsSignal = function(){
    switch (_46.ctor) {
      case '_Tuple2':
        return _46._0;
    }_E.Case($moduleName,'between lines 80 and 81')}();
  var buttonBar = F3(function(mode, width, height){
    return function(){
      var firstButton = (_N.eq(mode,Simulation) ? buttonPause : (Basics.otherwise ? buttonPlay : _E.If($moduleName,'on line 85, column 21 to 75')));
      var buttonArea = function(content){
        return border(Graphics.Collage.defaultLine)(A4(Graphics.Element.container, width, height, Graphics.Element.midLeft, content));};
      return buttonArea(Graphics.Element.flow(Graphics.Element.right)(_L.Cons(firstButton,buttonList)));}();});
  var scene = F2(function(dims, arg1){
    return function(){
      switch (arg1.ctor) {
        case '_Tuple2':
          return function(){
            var win = dims.window;
            var rArea = dims.renderArea;
            var pan = dims.panel;
            var bBar = dims.buttonBar;
            return A3(Graphics.Element.container, win.width, win.height, Graphics.Element.midTop)(A2(Graphics.Element.beside, A2(Graphics.Element.above, A3(buttonBar, arg1._0.mode, bBar.width, bBar.height), A2(renderArea, arg1, rArea.size)), A3(panel, arg1._1, pan.width, pan.height)));}();
      }_E.Case($moduleName,'between lines 43 and 47')}();});
  return elm.GUI = {
    _op : _op, 
    dimensions2 : dimensions2, 
    dimensions1 : dimensions1, 
    border : border, 
    colors : colors, 
    buttonSize : buttonSize, 
    nodeRadius : nodeRadius, 
    scene : scene, 
    dimensionsFromWindow : dimensionsFromWindow, 
    dimensionsFromWidth : dimensionsFromWidth, 
    dimensionsFromHeight : dimensionsFromHeight, 
    buttonPause : buttonPause, 
    buttonPlay : buttonPlay, 
    simulate : simulate, 
    buttonList : buttonList, 
    buttonsSignal : buttonsSignal, 
    buttonBar : buttonBar, 
    panel : panel, 
    drawGraph : drawGraph, 
    drawNodes : drawNodes, 
    drawNode : drawNode, 
    drawEdge : drawEdge, 
    drawEdges : drawEdges, 
    collageCenter : collageCenter, 
    relativeMousePosition : relativeMousePosition, 
    renderAreaCollage : renderAreaCollage, 
    renderArea : renderArea, 
    Select : Select, 
    Drag : Drag, 
    Simulation : Simulation, 
    Edit : Edit, 
    ButtonSelect : ButtonSelect, 
    ButtonMove : ButtonMove, 
    ButtonRotate : ButtonRotate, 
    ProgramState : ProgramState, 
    Dimensions : Dimensions};};
Elm.Physics = function(elm){
  var N = Elm.Native, _N = N.Utils(elm), _L = N.List(elm), _E = N.Error(elm), _J = N.JavaScript(elm), _str = _J.toString, $moduleName = 'Physics';
  var Text = Elm.Text(elm);
  var Text = Elm.Text(elm);
  var Basics = Elm.Basics(elm);
  var Signal = Elm.Signal(elm);
  var List = Elm.List(elm);
  var Maybe = Elm.Maybe(elm);
  var Time = Elm.Time(elm);
  var Prelude = Elm.Prelude(elm);
  var Graphics = Graphics || {};
  Graphics.Element = Elm.Graphics.Element(elm);
  var Color = Elm.Color(elm);
  var Graphics = Graphics || {};
  Graphics.Collage = Elm.Graphics.Collage(elm);
  var Dict = Elm.Dict(elm);
  var Dict = Elm.Dict(elm);
  var Set = Elm.Set(elm);
  var Set = Elm.Set(elm);
  var Point2D = Elm.Point2D(elm);
  var Point2D = Elm.Point2D(elm);
  var Graph = Elm.Graph(elm);
  var _op = {};
  var velocityStep = F2(function(delta, g){
    return function(){
      var vel2 = F2(function(pos, vel){
        return A2(Point2D.e_pls, pos, A2(Point2D.mul, vel, delta));});
      var vel = function(n){
        return _N.replace([['pos',A2(vel2, n.pos, n.vel)]], n);};
      return _N.replace([['nodes',A2(Dict.map, vel, g.nodes)]], g);}();});
  var precision = 1000000;
  var small_value = (1/Math.pow(precision,2));
  var positionDelta = F2(function(from, to){
    return A2(Point2D.e_min, to.pos, from.pos);});
  var nodeConstants = {
    _:{
    },
    mass:10,
    radius:3};
  var forceConstants = {
    _:{
    },
    equilibriumLength:60,
    repulsion:1000000,
    springConstant:50};
  var repulsion = F2(function(g, n){
    return function(){
      var r = F3(function(arg3, cn, f){
        return function(){
          return (_N.eq(cn.nid,n.nid) ? f : (Basics.otherwise ? function(){
            var d = A2(positionDelta, n, cn);
            var _1 = Point2D.breakDown(d);
            var l = function(){
              switch (_1.ctor) {
                case '_Tuple2':
                  return _1._0;
              }_E.Case($moduleName,'on line 68, column 21 to 34')}();
            var u = function(){
              switch (_1.ctor) {
                case '_Tuple2':
                  return _1._1;
              }_E.Case($moduleName,'on line 68, column 21 to 34')}();
            var f$ = (0-(forceConstants.repulsion/Math.pow(l,2)));
            return Point2D.e_pls(f)(A2(Point2D.mul, u, f$));}() : _E.If($moduleName,'between lines 64 and 70')));}();});
      return A3(Dict.foldl, r, Point2D.zero, g.nodes);}();});
  var nodeStep = F2(function(delta, g){
    return function(){
      var mrf = A2(Dict.map, repulsion(g), g.nodes);
      var appRep = function(n){
        return function(){
          var appRep$ = function(f){
            return function(){
              var _8 = Point2D.breakDown(f);
              var l = function(){
                switch (_8.ctor) {
                  case '_Tuple2':
                    return _8._0;
                }_E.Case($moduleName,'on line 78, column 23 to 36')}();
              var u = function(){
                switch (_8.ctor) {
                  case '_Tuple2':
                    return _8._1;
                }_E.Case($moduleName,'on line 78, column 23 to 36')}();
              var vl = ((l*delta)/nodeConstants.mass);
              var v = A2(Point2D.mul, u, vl);
              return _N.replace([['vel',A2(Point2D.e_pls, n.vel, v)]], n);}();};
          return A2(Maybe.maybe, n, appRep$)(A2(Dict.lookup, n.nid, mrf));}();};
      return _N.replace([['nodes',A2(Dict.map, appRep, g.nodes)]], g);}();});
  var drag = F2(function(arg2, n){
    return function(){
      return function(){
        var rho = 998.2071;
        var dF = (1/3000);
        var dens = (dF*rho);
        var coeff = 0.47;
        var area = (Basics.pi*Math.pow(nodeConstants.radius,2));
        var _16 = Point2D.breakDown(n.vel);
        var l = function(){
          switch (_16.ctor) {
            case '_Tuple2':
              return _16._0;
          }_E.Case($moduleName,'on line 116, column 15 to 32')}();
        var u = function(){
          switch (_16.ctor) {
            case '_Tuple2':
              return _16._1;
          }_E.Case($moduleName,'on line 116, column 15 to 32')}();
        var f = (0-((((Math.pow(l,2)*dens)*coeff)*area)/2));
        return A2(Point2D.mul, u, f);}();}();});
  var dragStep = F2(function(delta, g){
    return function(){
      var mdf = A2(Dict.map, drag(g), g.nodes);
      var appDrag = function(n){
        return function(){
          var appDrag$ = function(f){
            return function(){
              var _23 = Point2D.breakDown(f);
              var l = function(){
                switch (_23.ctor) {
                  case '_Tuple2':
                    return _23._0;
                }_E.Case($moduleName,'on line 133, column 23 to 36')}();
              var u = function(){
                switch (_23.ctor) {
                  case '_Tuple2':
                    return _23._1;
                }_E.Case($moduleName,'on line 133, column 23 to 36')}();
              var vl = ((l*delta)/nodeConstants.mass);
              var vl$ = A3(Basics.clamp, 0, Point2D.magn(n.vel), vl);
              var v = A2(Point2D.mul, u, vl$);
              return _N.replace([['vel',A2(Point2D.e_pls, n.vel, v)]], n);}();};
          return A2(Maybe.maybe, n, appDrag$)(A2(Dict.lookup, n.nid, mdf));}();};
      return _N.replace([['nodes',A2(Dict.map, appDrag, g.nodes)]], g);}();});
  var attraction = F2(function(g, n){
    return function(){
      var a = F3(function(arg3, cn, f){
        return function(){
          return (_N.eq(cn.nid,n.nid) ? f : (Basics.otherwise ? function(){
            var ei = A2(Set.union, A2(Set.intersect, n.edges, cn.bEdges), A2(Set.intersect, n.bEdges, cn.edges));
            return (_N.eq(Set.toList(ei),_J.toList([])) ? f : (Basics.otherwise ? function(){
              var d = A2(positionDelta, n, cn);
              var _31 = Point2D.breakDown(d);
              var l = function(){
                switch (_31.ctor) {
                  case '_Tuple2':
                    return _31._0;
                }_E.Case($moduleName,'on line 97, column 25 to 38')}();
              var u = function(){
                switch (_31.ctor) {
                  case '_Tuple2':
                    return _31._1;
                }_E.Case($moduleName,'on line 97, column 25 to 38')}();
              var f$ = (forceConstants.springConstant*(l-forceConstants.equilibriumLength));
              return Point2D.e_pls(f)(A2(Point2D.mul, u, f$));}() : _E.If($moduleName,'between lines 93 and 99')));}() : _E.If($moduleName,'between lines 88 and 99')));}();});
      return A3(Dict.foldl, a, Point2D.zero, g.nodes);}();});
  var edgeStep = F2(function(delta, g){
    return function(){
      var maf = A2(Dict.map, attraction(g), g.nodes);
      var appAttr = function(n){
        return function(){
          var appAttr$ = function(f){
            return function(){
              var _38 = Point2D.breakDown(f);
              var l = function(){
                switch (_38.ctor) {
                  case '_Tuple2':
                    return _38._0;
                }_E.Case($moduleName,'on line 107, column 23 to 36')}();
              var u = function(){
                switch (_38.ctor) {
                  case '_Tuple2':
                    return _38._1;
                }_E.Case($moduleName,'on line 107, column 23 to 36')}();
              var vl = ((l*delta)/nodeConstants.mass);
              var v = A2(Point2D.mul, u, vl);
              return _N.replace([['vel',A2(Point2D.e_pls, n.vel, v)]], n);}();};
          return A2(Maybe.maybe, n, appAttr$)(A2(Dict.lookup, n.nid, maf));}();};
      return _N.replace([['nodes',A2(Dict.map, appAttr, g.nodes)]], g);}();});
  var physicsStep = function(d){
    return (_N.eq(d,0) ? Basics.id : (Basics.otherwise ? function($){
      return velocityStep(d)(dragStep(d)(edgeStep(d)(nodeStep(d)($))));} : _E.If($moduleName,'on line 160, column 17 to 93')));};
  return elm.Physics = {
    _op : _op, 
    nodeConstants : nodeConstants, 
    forceConstants : forceConstants, 
    precision : precision, 
    small_value : small_value, 
    positionDelta : positionDelta, 
    repulsion : repulsion, 
    nodeStep : nodeStep, 
    attraction : attraction, 
    edgeStep : edgeStep, 
    drag : drag, 
    dragStep : dragStep, 
    velocityStep : velocityStep, 
    physicsStep : physicsStep};};
Elm.Graph = function(elm){
  var N = Elm.Native, _N = N.Utils(elm), _L = N.List(elm), _E = N.Error(elm), _J = N.JavaScript(elm), _str = _J.toString, $moduleName = 'Graph';
  var Text = Elm.Text(elm);
  var Text = Elm.Text(elm);
  var Basics = Elm.Basics(elm);
  var Signal = Elm.Signal(elm);
  var List = Elm.List(elm);
  var Maybe = Elm.Maybe(elm);
  var Time = Elm.Time(elm);
  var Prelude = Elm.Prelude(elm);
  var Graphics = Graphics || {};
  Graphics.Element = Elm.Graphics.Element(elm);
  var Color = Elm.Color(elm);
  var Graphics = Graphics || {};
  Graphics.Collage = Elm.Graphics.Collage(elm);
  var List = Elm.List(elm);
  var Dict = Elm.Dict(elm);
  var Dict = Elm.Dict(elm);
  var Set = Elm.Set(elm);
  var Set = Elm.Set(elm);
  var Maybe = Elm.Maybe(elm);
  var Point2D = Elm.Point2D(elm);
  var Point2D = Elm.Point2D(elm);
  var TGF = Elm.TGF(elm);
  var _op = {};
  var nodesWithin = F3(function(maxDist, g, mpos){
    return function(){
      var overlap = function(n){
        return function(){
          var dist = Point2D.magn(A2(Point2D.e_min, n.pos, mpos));
          return (_N.cmp(dist,maxDist)<0);}();};
      return List.filter(overlap)(Dict.values(g.nodes));}();});
  var Node = F6(function(a, b, c, d, e, f){
    return {
      _:{
      },
      bEdges:f,
      edges:e,
      label:b,
      nid:a,
      pos:c,
      vel:d};});
  var Graph = F2(function(a, b){
    return {
      _:{
      },
      edges:b,
      nodes:a};});
  var createGraph = F2(function(spacing, g){
    return function(){
      var gridSize = Basics.ceiling(Basics.sqrt(Basics.toFloat(List.length(g.nodes))));
      var gridPos = F2(function(s, i){
        return function(){
          var space = function(p){
            return A2(Point2D.mul, p, s);};
          var gridPoint = Point2D.cartesian({ctor:"_Tuple2", _0:Basics.toFloat(A2(Basics.mod, i, gridSize)), _1:Basics.toFloat((i/gridSize|0))});
          return space(gridPoint);}();});
      var edges$ = List.map(function(arg1){
        return function(){
          switch (arg1.ctor) {
            case '_Tuple2':
              return {ctor:"_Tuple2", _0:arg1._0, _1:_N.insert('eid', arg1._0, arg1._1)};
          }_E.Case($moduleName,'on line 52, column 32 to 43')}();})(A2(List.zip, _L.range(1,List.length(g.edges)), g.edges));
      var newEdges = Dict.fromList(edges$);
      var tgfnode2node = function(n){
        return {ctor:"_Tuple2", _0:n.id, _1:A6(Node, n.id, n.label, A2(gridPos, spacing, n.id), Point2D.zero, Set.fromList(List.map(Basics.fst)(A2(List.filter, function(arg1){
          return function(){
            switch (arg1.ctor) {
              case '_Tuple2':
                return _N.eq(arg1._1.idFrom,n.id);
            }_E.Case($moduleName,'on line 66, column 82 to 98')}();}, edges$))), Set.fromList(List.map(Basics.fst)(A2(List.filter, function(arg1){
          return function(){
            switch (arg1.ctor) {
              case '_Tuple2':
                return _N.eq(arg1._1.idTo,n.id);
            }_E.Case($moduleName,'on line 67, column 82 to 98')}();}, edges$))))};};
      var newNodes = Dict.fromList(A2(List.map, tgfnode2node, g.nodes));
      return A2(Graph, newNodes, newEdges);}();});
  var Edge = F4(function(a, b, c, d){
    return {
      _:{
      },
      eid:a,
      idFrom:b,
      idTo:c,
      label:d};});
  return elm.Graph = {
    _op : _op, 
    createGraph : createGraph, 
    nodesWithin : nodesWithin, 
    Node : Node, 
    Edge : Edge, 
    Graph : Graph};};
Elm.Point2D = function(elm){
  var N = Elm.Native, _N = N.Utils(elm), _L = N.List(elm), _E = N.Error(elm), _J = N.JavaScript(elm), _str = _J.toString, $moduleName = 'Point2D';
  var Text = Elm.Text(elm);
  var Text = Elm.Text(elm);
  var Basics = Elm.Basics(elm);
  var Signal = Elm.Signal(elm);
  var List = Elm.List(elm);
  var Maybe = Elm.Maybe(elm);
  var Time = Elm.Time(elm);
  var Prelude = Elm.Prelude(elm);
  var Graphics = Graphics || {};
  Graphics.Element = Elm.Graphics.Element(elm);
  var Color = Elm.Color(elm);
  var Graphics = Graphics || {};
  Graphics.Collage = Elm.Graphics.Collage(elm);
  var _op = {};
  var zipWith = F3(function(f, a, b){
    return {
      _:{
      },
      x:A2(f, a.x, b.x),
      y:A2(f, a.y, b.y)};});
  var toCarthesian = function(arg1){
    return function(){
      return {ctor:"_Tuple2", _0:arg1.x, _1:arg1.y};}();};
  var polar = function(arg1){
    return function(){
      switch (arg1.ctor) {
        case '_Tuple2':
          return {
            _:{
            },
            x:(arg1._0*Basics.cos(arg1._1)),
            y:(arg1._0*Basics.sin(arg1._1))};
      }_E.Case($moduleName,'on line 35, column 20 to 52')}();};
  var map = F2(function(f, arg1){
    return function(){
      return {
        _:{
        },
        x:f(arg1.x),
        y:f(arg1.y)};}();});
  var fold = F2(function(f, arg1){
    return function(){
      return A2(f, arg1.x, arg1.y);}();});
  var e_pls = zipWith(F2(function(a, b){
    return (a+b);}));
  var e_mul = zipWith(F2(function(a, b){
    return (a*b);}));
  var e_min = zipWith(F2(function(a, b){
    return (a-b);}));
  var e_div = zipWith(F2(function(a, b){
    return (a/b);}));
  var dot = F2(function(a, b){
    return fold(F2(function(a, b){
      return (a+b);}))(A2(e_mul, a, b));});
  var magn = function(p){
    return Basics.sqrt(A2(dot, p, p));};
  var cartesian = function(arg1){
    return function(){
      switch (arg1.ctor) {
        case '_Tuple2':
          return {
            _:{
            },
            x:arg1._0,
            y:arg1._1};
      }_E.Case($moduleName,'on line 32, column 22 to 34')}();};
  var Point2D = F2(function(a, b){
    return {
      _:{
      },
      x:a,
      y:b};});
  var from1D = function(a){
    return A2(Point2D, a, a);};
  var div = F2(function(p, s){
    return A2(e_div, p, from1D(s));});
  var unit$ = div;
  var breakDown = function(p){
    return function(){
      var m = magn(p);
      return {ctor:"_Tuple2", _0:m, _1:A2(unit$, p, m)};}();};
  var toPolar = function(p){
    return function(){
      var _9 = breakDown(p);
      var r = function(){
        switch (_9.ctor) {
          case '_Tuple2':
            return _9._0;
        }_E.Case($moduleName,'on line 41, column 25 to 36')}();
      var u = function(){
        switch (_9.ctor) {
          case '_Tuple2':
            return _9._1;
        }_E.Case($moduleName,'on line 41, column 25 to 36')}();
      return {ctor:"_Tuple2", _0:r, _1:A2(Basics.atan2, u.x, u.y)};}();};
  var unit = function(p){
    return unit$(p)(magn(p));};
  var min = F2(function(p, s){
    return A2(e_min, p, from1D(s));});
  var mul = F2(function(p, s){
    return A2(e_mul, p, from1D(s));});
  var pls = F2(function(p, s){
    return A2(e_pls, p, from1D(s));});
  var zero = from1D(0);
  return elm.Point2D = {
    _op : _op, 
    cartesian : cartesian, 
    polar : polar, 
    toCarthesian : toCarthesian, 
    toPolar : toPolar, 
    zero : zero, 
    map : map, 
    fold : fold, 
    zipWith : zipWith, 
    e_pls : e_pls, 
    e_min : e_min, 
    e_mul : e_mul, 
    e_div : e_div, 
    pls : pls, 
    min : min, 
    mul : mul, 
    div : div, 
    dot : dot, 
    magn : magn, 
    from1D : from1D, 
    unit$ : unit$, 
    unit : unit, 
    breakDown : breakDown, 
    Point2D : Point2D};};
Elm.TGF = function(elm){
  var N = Elm.Native, _N = N.Utils(elm), _L = N.List(elm), _E = N.Error(elm), _J = N.JavaScript(elm), _str = _J.toString, $moduleName = 'TGF';
  var Text = Elm.Text(elm);
  var Text = Elm.Text(elm);
  var Basics = Elm.Basics(elm);
  var Signal = Elm.Signal(elm);
  var List = Elm.List(elm);
  var Maybe = Elm.Maybe(elm);
  var Time = Elm.Time(elm);
  var Prelude = Elm.Prelude(elm);
  var Graphics = Graphics || {};
  Graphics.Element = Elm.Graphics.Element(elm);
  var Color = Elm.Color(elm);
  var Graphics = Graphics || {};
  Graphics.Collage = Elm.Graphics.Collage(elm);
  var Char = Elm.Char(elm);
  var Maybe = Elm.Maybe(elm);
  var _op = {};
  var toString = function(graph){
    return function(){
      var nodeToString = function(node){
        return A2(List.join, _str(' '), _J.toList([Prelude.show(node.id),node.label]));};
      var edgeToString = function(edge){
        return A2(List.join, _str(' '), _J.toList([Prelude.show(edge.idFrom),Prelude.show(edge.idTo),edge.label]));};
      return List.join(_str('\n#\n'))(A2(List.map, List.join(_str('\n')), _J.toList([A2(List.map, nodeToString, graph.nodes),A2(List.map, edgeToString, graph.edges)])));}();};
  var splitOn = F2(function(pred, list){
    return function(){
      switch (list.ctor) {
        case '::':
          return (pred(list._0) ? {ctor:"_Tuple2", _0:_J.toList([]), _1:list._1} : (Basics.otherwise ? function(){
            var _3 = A2(splitOn, pred, list._1);
            var l = function(){
              switch (_3.ctor) {
                case '_Tuple2':
                  return _3._0;
              }_E.Case($moduleName,'on line 52, column 37 to 54')}();
            var r = function(){
              switch (_3.ctor) {
                case '_Tuple2':
                  return _3._1;
              }_E.Case($moduleName,'on line 52, column 37 to 54')}();
            return {ctor:"_Tuple2", _0:_L.Cons(list._0,l), _1:r};}() : _E.If($moduleName,'between lines 49 and 53')));
        case '[]':
          return {ctor:"_Tuple2", _0:_J.toList([]), _1:_J.toList([])};
      }_E.Case($moduleName,'between lines 48 and 54')}();});
  var empty = {
    _:{
    },
    edges:_J.toList([]),
    nodes:_J.toList([])};
  var dropWhile = F2(function(pred, list){
    return function(){
      switch (list.ctor) {
        case '::':
          return (pred(list._0) ? A2(dropWhile, pred, list._1) : (Basics.otherwise ? list : _E.If($moduleName,'on line 43, column 21 to 68')));
        case '[]':
          return _J.toList([]);
      }_E.Case($moduleName,'between lines 42 and 44')}();});
  var fromString = function(str){
    return function(){
      var notDigit = function($char){
        return Basics.not(Char.isDigit($char));};
      var nodeFromString = function(str){
        return function(){
          var _13 = A2(splitOn, notDigit, str);
          var idStr = function(){
            switch (_13.ctor) {
              case '_Tuple2':
                return _13._0;
            }_E.Case($moduleName,'on line 60, column 30 to 50')}();
          var label = function(){
            switch (_13.ctor) {
              case '_Tuple2':
                return _13._1;
            }_E.Case($moduleName,'on line 60, column 30 to 50')}();
          return function(){
            var case20 = Prelude.readInt(idStr);
            switch (case20.ctor) {
              case 'Just':
                return Maybe.Just({
                  _:{
                  },
                  id:case20._0,
                  label:label});
              case 'Nothing':
                return Maybe.Nothing;
            }_E.Case($moduleName,'between lines 61 and 64')}();}();};
      var edgeFromString = function(str){
        return function(){
          var _22 = A2(splitOn, notDigit, str);
          var idStr1 = function(){
            switch (_22.ctor) {
              case '_Tuple2':
                return _22._0;
            }_E.Case($moduleName,'on line 65, column 30 to 50')}();
          var rest = function(){
            switch (_22.ctor) {
              case '_Tuple2':
                return _22._1;
            }_E.Case($moduleName,'on line 65, column 30 to 50')}();
          var _29 = splitOn(notDigit)(A2(dropWhile, notDigit, rest));
          var idStr2 = function(){
            switch (_29.ctor) {
              case '_Tuple2':
                return _29._0;
            }_E.Case($moduleName,'on line 66, column 31 to 74')}();
          var label = function(){
            switch (_29.ctor) {
              case '_Tuple2':
                return _29._1;
            }_E.Case($moduleName,'on line 66, column 31 to 74')}();
          return function(){
            var case36 = {ctor:"_Tuple2", _0:Prelude.readInt(idStr1), _1:Prelude.readInt(idStr2)};
            switch (case36.ctor) {
              case '_Tuple2':
                switch (case36._0.ctor) {
                  case 'Just':
                    switch (case36._1.ctor) {
                      case 'Just':
                        return Maybe.Just({
                          _:{
                          },
                          idFrom:case36._0._0,
                          idTo:case36._1._0,
                          label:label});
                    }break;
                }break;
            }
            return Maybe.Nothing;}();}();};
      var lines = A2(List.split, _str('\n'), str);
      var _41 = A2(splitOn, F2(function(x, y){
        return _N.eq(x,y);})(_str('#')), lines);
      var edgeStrings = function(){
        switch (_41.ctor) {
          case '_Tuple2':
            return _41._1;
        }_E.Case($moduleName,'on line 72, column 38 to 62')}();
      var nodeStrings = function(){
        switch (_41.ctor) {
          case '_Tuple2':
            return _41._0;
        }_E.Case($moduleName,'on line 72, column 38 to 62')}();
      var maybeEdges = A2(List.map, edgeFromString, edgeStrings);
      var maybeNodes = A2(List.map, nodeFromString, nodeStrings);
      return (Basics.not((A2(List.any, Maybe.isNothing, maybeNodes)||A2(List.any, Maybe.isNothing, maybeEdges))) ? {
        _:{
        },
        edges:Maybe.justs(maybeEdges),
        nodes:Maybe.justs(maybeNodes)} : (Basics.otherwise ? empty : _E.If($moduleName,'between lines 76 and 78')));}();};
  var TGFNode = F2(function(a, b){
    return {
      _:{
      },
      id:a,
      label:b};});
  var TGFGraph = F2(function(a, b){
    return {
      _:{
      },
      edges:b,
      nodes:a};});
  var TGFEdge = F3(function(a, b, c){
    return {
      _:{
      },
      idFrom:a,
      idTo:b,
      label:c};});
  return elm.TGF = {
    _op : _op, 
    empty : empty, 
    dropWhile : dropWhile, 
    splitOn : splitOn, 
    fromString : fromString, 
    toString : toString, 
    TGFNode : TGFNode, 
    TGFEdge : TGFEdge, 
    TGFGraph : TGFGraph};};
        </script>
    </head>
    <body>
        <script type="text/javascript">
            Elm.fullscreen(Elm.Main)
        </script>
        <noscript>
            
        </noscript>
    </body>
</html>
